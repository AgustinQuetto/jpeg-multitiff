const express = require('express')
const router = express.Router()
const sharp = require('sharp')
const fs = require('fs')

/* GET home page. */
// router.get('/', function (req, res, next) {
//  res.render('index', { title: 'Express' })
// })

router.post('/', (req, res, next) => {
  /*
  const downsizeProfileImgForTweet = (path) => {
    let imgBuffer = Buffer.from(path, 'base64')
    sharp(imgBuffer)
      .flatten()
      .tiff()
      .toFile('public/images/data.tif')
      .then(data => {
        console.log('success')
        console.log(data)
        res.sendStatus(200)
      })
      .catch(err => console.log(`downisze issue ${err}`))
  }

  downsizeProfileImgForTweet('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')

  let jpeg = fs.readFileSync('public/images/SP000.jpg')

  // convert buffers
  sharp(jpeg).toFile('public/images/SP000.tif')
  */
  // convert files
  let imgBuffer = Buffer.from(req.body.imagen, 'base64')
  sharp(imgBuffer).toFile('public/images/output/SP0001.tif')
})

module.exports = router
